---
title: "【C++】ポインタと参照の違い・値渡しと参照渡し・関数ポインタ・スマートポインター"
source: "https://kazulog.fun/dev/c-plus-plus-pointer-reference/"
author:
  - "[[かずログ]]"
published: 2024-04-22
created: 2025-08-26
description: "ポインタはアドレス（メモリ空間上の位置）を格納する変数。変数宣言を行う際に、変数用のメモリが確保され、メモリ空間上に配置される。しかし、変数宣言直後はポインタには不定値が格納されており、どこを指しているか分からない状態。変数名の前に `&amp;` 記号をつけることで、その変数のアドレスを取得できる。"
tags:
  - "clippings"
---
[方言を話すおしゃべり猫型ロボット『ミーア』をリリースしました（こちらをクリック）](https://mia-cat.com/)

[ホーム](https://kazulog.fun/)

## ポインタ：アドレスを格納する変数

- ポインタ＝アドレス（メモリ空間上の位置）を格納する変数
- ポインタ変数も `int`  型や  `char` 型などの基本型の変数同様に、変数宣言を行う際に、その変数用のメモリが確保され、メモリ空間上に配置される。しかし、 変数宣言直後は、ポインタには不定値が格納されており、どこを指しているか分からない状態。
- 変数名の前に `&` 記号をつけることで、その変数のアドレスを取得できる。
- デリファレンス（逆参照）：ポインタ変数の前に `*` （間接演算子）を付けることで、このポインタに格納されたアドレスのデータにアクセスできる。

詳細はこちら： [https://daeudaeu.com/pointer/](https://daeudaeu.com/pointer/)

### ポインタ変数宣言

下記では、 `**x**` は `**'A'**` で初期化されているので、 `**ptr**` は `**x**` のアドレスを指し、 `***ptr**` （ `**ptr**` が指す値）は `**'A'**` になる。

下記の場合、 `**x**` は初期化されていない。したがって、 `**x**` に格納されている値は不定であり、 `***ptr**` の結果も未定義（undefined）。

ポインタ変数を宣言する際には、有効なメモリアドレスを割り当てるか、 `**nullptr**` や `**NULL**` で初期化することが推奨される。 直接具体的なアドレス値を代入することは、特殊な状況を除いて避けるべき。

## ポインタと参照の違い

| **特徴** | **ポインタ** | **参照** |
| --- | --- | --- |
| 定義 | ポインタが指し示すアドレスに格納されている値にアクセスする操作。 Windows のショートカットや Linux のシンボリックリンクと同じような機能。 | 参照自体がデリファレンスされた値として振る舞う。 |
| **初期化** | 初期化せずに宣言可能。 `**nullptr**` に初期化可能。 | 宣言時に必ず初期化する必要がある。 |
| **再代入** | 異なるアドレスを指し示すように変更可能。 | 一度初期化すると、別のオブジェクトを参照するように変更不可。 |
| **‘null’ 状態** | `**nullptr**` を指し示すことができる。 | ‘null’参照は存在しない。 |
| **値にアクセス** | デリファレンス（逆参照）（ `*****` ）を使ってアクセス。 int x = 5; int\* p = &x; // pはポインタ型 int y = \*p; // \*を使って逆参照（でリファレンス）して値にアクセス | 直接アクセス可能。 int x = 100; int& r = x; // rは参照型 r = 200; // 直接値を書き換え |
| **メモリアドレス** | 明示的にアドレス（ `**&**` ）を取得して操作。 | アドレスを直接扱わない。 |
| **操作性** | アドレス算術が可能。 | 提供される操作が限定的。 |
| **安全性** | ポインタは誤った使い方をすると危険。 | 参照はより安全で、未初期化の状態がない。 |
| **使用例** | 動的なメモリ管理、配列操作など。 | 関数の引数や戻り値、オブジェクトのエイリアスなど。 |

スクロールできます

## 値渡しと参照渡し

### 値渡し（pass by value）

- 値渡しの場合、関数に引数として渡されるのは変数の値のコピー
- そのため、関数内で引数の値を変更しても、それはコピーされた値に対する変更であるため、関数外の元の変数には影響しない。
- 関数で行った変更を関数外の変数に反映させたい場合は、 returnメソッドで関数から値を戻り値として返し、それを外の変数に再代入する必要がある 。ただし、 `return` で渡せるデータは１つなので、 関数が呼び出し元に渡せる結果は１つのデータのみ。

### 参照渡し（pass by reference）

- 参照渡しの場合、関数に引数として渡されるのは変数のアドレス（または参照）。
- 関数実行時に引数として渡されたデータの複製が作成されるのは同じだが、ポインタの場合はポインタに格納されたアドレスが複製される。 したがって、ポインタ変数としては全く別のものでも、関数呼び出しにより複製されたポインタも複製元のポインタが指している場所を同様に指す。
- このため、 関数内で引数を通じて値を変更すると、その変更はメモリ上の同じアドレスに保存されている値に対して行われるため、関数外の変数に直接反映される。
- この場合、関数外の変数を更新するために再代入する必要はない。
![](https://kazulog.fun/wp-content/uploads/2024/04/image-28.png.webp)

出典： https://daeudaeu.com/pointer/#i-10

C++で参照渡しを実現するには、2つの方法がある。

１）引数としてポインタを使用する

２）参照を使用する

### コピー時間の短縮によるプログラムの高速化

値渡しの場合

- 引数の型によってデータサイズが決まる 。たとえば、int 型の場合は通常4バイト、char 型の場合は通常1バイト。

参照渡し（ポインタ渡し）の場合

- 関数に渡されるのはポインタであり、その ポインタのサイズはプラットフォームに依存する。32ビットアーキテクチャでは4バイト、64ビットアーキテクチャでは8バイト。

参照渡しの場合、大きなデータ構造を扱う場合や、データのサイズが実行環境に依存する場合でも、効率的に関数を呼び出すことができ、結果プログラムの実行速度を向上できる。

## 関数ポインタ

- 関数を指すポインタ。関数も変数等と同様にプログラム実行時にメモリ上に展開され、メモリ上に存在することになる。
- 関数ポインタの変数宣言。関数の戻り値と引数の型に合わせて変数宣言する： 戻り値の型 (\*変数名)(引数１の型, 引数２の型);
- 関数ポインタへのアドレス格納：単純に関数ポインタへ関数名を代入すればよい。ただし、関数名には関数ポインタの変数名を使用する。
- 関数ポインタは、コールバック関数や、実行時に関数を選択する際など、柔軟なプログラミングが必要な場合に特に有用。

関数ポインタを使った場合

- 演算子に対応する関数ポインタを `**operation**` に格納し、そのポインタを使用して選択された演算を実行する。これにより、関数の切り替えが簡単に行える。

関数ポインタを使わない場合

- 演算子ごとに条件分岐を使って直接関数を呼び出す必要がある

関数ポインタを使う場面

**コールバック関数**

- 関数のアドレスを渡し、渡した先でその関数を実行してもらう 場合。マルチスレッドや並列プログラミングでは、複数の処理が同時に進んでいるため、一つの処理が終わったら別の処理を実行したいという状況が発生し、その際にコールバック関数が役立つ。

`**addNumbers**` 関数が通常の引数として整数を2つと、関数ポインタ（コールバック）を受け取り、特定の条件下でそのポインタを通じてコールバック関数を呼び出す。

## メモリ管理：スマートポインター

スマートポインター

- スマートポインターは、ポインターをより賢く使うためのツール
- 最新のC++では、生ポインターを使用せずに、生のポインターをスマートポインターでラップすることを推奨している。
- デストラクターが呼び出されたときにメモリを自動的に解放する。 (つまり、コードがスマート ポインターのスコープ外になった場合)。
[

![](https://learn.microsoft.com/en-us/media/open-graph-image.png)

スマート ポインター (Modern C++)

詳細情報: スマート ポインター (Modern C++)

learn.microsoft.com

](https://learn.microsoft.com/ja-jp/cpp/cpp/smart-pointers-modern-cpp?view=msvc-170 "スマート ポインター (Modern C++)")

生ポインターを使った場合：

スマートポインター（ここでは `std::unique_ptr` ）を使った場合![](https://kazulog.fun/wp-content/uploads/2024/04/Your-paragraph-text-1-3.jpg.webp)

[

【Flutter】通知メッセージ表示としてOverlayクラスを導入する

](https://kazulog.fun/dev/flutter-oveerlay-support/ "【Flutter】通知メッセージ表示としてOverlayクラスを導入する")[![](https://kazulog.fun/wp-content/uploads/2024/04/Your-paragraph-text-2-3.jpg.webp)

【リバースプロキシ】を活用してサブドメインのSEOパワーをサブディレクトリに統合する方法

](https://kazulog.fun/marketing/reverse-proxy-subdomain-to-subdirectory-seo/ "【リバースプロキシ】を活用してサブドメインのSEOパワーをサブディレクトリに統合する方法")

- - [お問い合わせ](https://kazulog.fun/contact/)
- [ホーム](https://kazulog.fun/)
- 
- [トップ](https://kazulog.fun/dev/c-plus-plus-pointer-reference/#)
-

タイトルとURLをコピーしました